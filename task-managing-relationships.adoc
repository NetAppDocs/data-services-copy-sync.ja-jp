---
sidebar: sidebar 
permalink: task-managing-relationships.html 
keywords: sync, immediate, now, schedule, minutes, hours, on, off, delete, group, accelerate, accelerating, grouping, multiple data brokers, sync now, turn off, turn on, sync schedule, settings, change settings, recently modified files, delete files on target, retries, retry, file types, exclude file type, include file type, delete relationship 
summary: データを即時に同期したり、スケジュールを変更したりすることで、いつでも同期関係を管理できます。 
---
= NetApp Copy and Sync での同期関係の管理
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
NetApp Copy and Sync では、データの即時同期、スケジュールの変更などにより、いつでも同期関係を管理できます。



== 即時データ同期を実行する

次のスケジュールされた同期を待つのではなく、ソースとターゲットの間でデータをすぐに同期できます。

.手順
. link:task-login-copyandsync.html["コピーと同期にログイン"] 。
. *ダッシュボード*から同期関係に移動し、image:icon-sync-action.png["同期関係でアクションを実行できるボタンのスクリーンショット"]
. *今すぐ同期*を選択し、*同期*を選択して確認します。


.結果
コピーと同期は、関係のデータ同期プロセスを開始します。



== 同期パフォーマンスを高速化

関係を管理するグループに追加のデータ ブローカーを追加することで、同期関係のパフォーマンスを高速化します。追加のデータ ブローカーは、新しいデータ ブローカーである必要があります。

.仕組み
データ ブローカー グループが他の同期関係を管理している場合、グループに追加する新しいデータ ブローカーによって、それらの同期関係のパフォーマンスも向上します。

たとえば、次の 3 つの関係があるとします。

* 関係1はデータブローカーグループAによって管理されます
* 関係2はデータブローカーグループBによって管理されます
* 関係3はデータブローカーグループAによって管理されます


リレーションシップ 1 のパフォーマンスを高速化したいので、新しいデータ ブローカーをデータ ブローカー グループ A に追加します。グループ A は同期リレーションシップ 3 も管理しているため、リレーションシップの同期パフォーマンスも自動的に高速化されます。

.手順
. 関係にある既存のデータ ブローカーの少なくとも 1 つがオンラインであることを確認します。
. *ダッシュボード*から同期関係に移動し、image:icon-sync-action.png["同期関係でアクションを実行できるボタンのスクリーンショット"]
. *加速*を選択します。
. 指示に従って新しいデータ ブローカーを作成します。


.結果
コピーと同期により、新しいデータ ブローカーがグループに追加されます。次のデータ同期のパフォーマンスが高速化されるはずです。



== 資格情報を更新する

既存の同期関係のソースまたはターゲットの最新の資格情報を使用してデータ ブローカーを更新できます。セキュリティ ポリシーにより定期的に資格情報を更新する必要がある場合は、資格情報を更新すると役立ちます。

資格情報の更新は、コピーと同期で資格情報が必要となるソースまたはターゲット (Azure Blob、Box、IBM Cloud Object Storage、 StorageGRID、 ONTAP S3 ストレージ、SFTP、SMB サーバー) でサポートされています。

.手順
. *同期ダッシュボード*から、資格情報を必要とする同期関係に移動し、*資格情報の更新*を選択します。
+
image:screenshot_sync_update_credentials.png["ソースまたはターゲットの名前のすぐ下にある「同期関係」ページの「資格情報の更新」オプションを示すスクリーンショット。"]

. 資格情報を入力し、「更新」を選択します。
+
SMB サーバーに関する注意: ドメインが新しい場合は、資格情報を更新するときにそれを指定する必要があります。ドメインが変更されていない場合は、再度入力する必要はありません。

+
同期関係を作成するときにドメインを入力したが、資格情報を更新するときに新しいドメインを入力しなかった場合、コピーと同期では、指定した元のドメインが引き続き使用されます。



.結果
コピーと同期により、データ ブローカーの資格情報が更新されます。データ ブローカーがデータ同期に更新された資格情報を使用し始めるまで、最大 10 分かかる場合があります。



== 通知を設定する

各同期関係の *通知* 設定により、 NetAppコンソールの通知センターでコピーと同期の通知を受信するかどうかを選択できます。成功したデータ同期、失敗したデータ同期、キャンセルされたデータ同期に関する通知を有効にすることができます。

image:https://raw.githubusercontent.com/NetAppDocs/bluexp-copy-sync/main/media/screenshot-notification-center.png["NetAppコンソールの通知センターを示すスクリーンショット。"]

また、メールで通知を受け取ることもできます。

.手順
. 同期関係の設定を変更します。
+
.. *ダッシュボード*から同期関係に移動し、image:icon-sync-action.png["同期関係でアクションを実行できるボタンのスクリーンショット"]
.. *設定*を選択します。
.. *通知*を有効にします。
.. *設定を保存*を選択します。


. 電子メールで通知を受信する場合は、アラートと通知の設定を構成します。
+
.. *設定 > アラートと通知の設定*を選択します。
.. ユーザーまたは複数のユーザーを選択し、「情報」通知タイプを選択します。
.. *適用*を選択します。




.結果
NetAppコンソールの通知センターでコピーと同期の通知が受信されるようになり、オプションを設定している場合は電子メールで通知がいくつか届きます。



== 同期関係の設定を変更する

ソース ファイルとフォルダーをターゲットの場所で同期および維持する方法を定義する設定を変更します。

. *ダッシュボード*から同期関係に移動し、image:icon-sync-action.png["同期関係でアクションを実行できるボタンのスクリーンショット"]
. *設定*を選択します。
. いずれかの設定を変更します。
+
image:screenshot_sync_settings.png["同期関係の設定を示すスクリーンショット。"]

+
[[deleteonsource]] 各設定の簡単な説明は次のとおりです。

+
スケジュール:: 今後の同期の定期スケジュールを選択するか、同期スケジュールをオフにします。関係を 1 分ごとに同期するようにスケジュールできます。
同期タイムアウト:: 指定された分数、時間数、または日数内に同期が完了しなかった場合に、コピーと同期でデータ同期をキャンセルするかどうかを定義します。
通知:: NetAppコンソールの通知センターでコピーと同期の通知を受信するかどうかを選択できます。成功したデータ同期、失敗したデータ同期、キャンセルされたデータ同期に関する通知を有効にすることができます。
+
--
通知を受け取りたい場合は

--
再試行:: コピーと同期がファイルをスキップする前に同期を再試行する回数を定義します。
比較する:: ファイルまたはディレクトリが変更されたかどうか、再度同期する必要があるかどうかを判断するときに、コピーと同期で特定の属性を比較するかどうかを選択します。
+
--
これらの属性のチェックを外しても、コピーと同期はパス、ファイル サイズ、ファイル名をチェックしてソースとターゲットを比較します。変更があった場合は、それらのファイルとディレクトリが同期されます。

次の属性を比較して、コピーと同期を有効にするか無効にするかを選択できます。

** *mtime*: ファイルの最終更新時刻。この属性はディレクトリには無効です。
** *uid*、*gid*、および *mode*: Linux の権限フラグ。


--
オブジェクトのコピー:: 関係を作成した後は、このオプションを編集することはできません。
最近変更されたファイル:: スケジュールされた同期の前に最近変更されたファイルを除外することを選択します。
ソース上のファイルを削除:: コピーと同期によってファイルがターゲットの場所にコピーされた後、ソースの場所からファイルを削除することを選択します。このオプションでは、ソース ファイルがコピー後に削除されるため、データが失われるリスクがあります。
+
--
このオプションを有効にする場合は、データ ブローカーの local.json ファイル内のパラメーターも変更する必要があります。ファイルを開き、次のように更新します。

[source, json]
----
{
"workers":{
"transferrer":{
"delete-on-source": true
}
}
}
----
local.json ファイルを更新した後、再起動する必要があります。 `pm2 restart all` 。

--
ターゲット上のファイルを削除する:: ソースからファイルが削除された場合は、ターゲットの場所からファイルを削除することを選択します。デフォルトでは、ターゲットの場所からファイルは削除されません。
ファイルの種類:: 各同期に含めるファイルの種類（ファイル、ディレクトリ、シンボリック リンク、ハード リンク）を定義します。
+
--

NOTE: ハード リンクは、セキュリティ保護されていない NFS と NFS の関係でのみ使用できます。ユーザーは 1 つのスキャナー プロセスと 1 つのスキャナー同時実行に制限され、スキャンはルート ディレクトリから実行する必要があります。

--
ファイル拡張子を除外する:: ファイル拡張子を入力して Enter キーを押すことで、同期から除外する正規表現またはファイル拡張子を指定します。たとえば、*.log ファイルを除外するには、「_log_」または「_.log_」と入力します。複数の拡張子の場合、区切り文字は必要ありません。次のビデオでは短いデモを紹介します。
+
--
.同期関係のファイル拡張子を除外する
video::7f957dbf-9215-41ea-a705-b24c010b2212[panopto]

NOTE: Regex または正規表現は、ワイルドカードや glob 表現とは異なります。この機能は正規表現でのみ動作します。

--
ディレクトリを除外する:: 同期から除外する正規表現またはディレクトリを最大 15 個指定するには、名前またはディレクトリのフル パスを入力し、*Enter* キーを押します。デフォルトでは、.copy-offload、.snapshot、~snapshot ディレクトリは除外されます。
+
--

NOTE: Regex または正規表現は、ワイルドカードや glob 表現とは異なります。この機能は正規表現でのみ動作します。

--
ファイル サイズ:: サイズに関係なくすべてのファイルを同期するか、特定のサイズ範囲内のファイルのみを同期するかを選択します。
更新日:: 最終更新日に関係なくすべてのファイル、特定の日付以降、特定の日付前、または時間範囲内で更新されたファイルを選択します。
作成日:: SMB サーバーがソースの場合、この設定により、特定の日付以降、特定の日付前、または特定の時間範囲内に作成されたファイルを同期できます。
ACL - アクセス制御リスト:: 関係を作成するとき、または関係を作成した後に設定を有効にして、SMB サーバーから ACL のみ、ファイルのみ、または ACL とファイルをコピーします。


. *設定を保存*を選択します。


.結果
コピーして同期すると、新しい設定で同期関係が変更されます。



== 関係を削除する

ソースとターゲットの間でデータを同期する必要がなくなった場合は、同期関係を削除できます。このアクションでは、データ ブローカー グループ (または個々のデータ ブローカー インスタンス) は削除されず、ターゲットからデータも削除されません。



=== オプション1: 単一の同期関係を削除する

.手順
. *ダッシュボード*から同期関係に移動し、image:icon-sync-action.png["同期関係でアクションを実行できるボタンのスクリーンショット"]
. *削除*を選択し、もう一度*削除*を選択して確定します。


.結果
コピーして同期すると、同期関係が削除されます。



=== オプション2: 複数の同期関係を削除する

.手順
. *ダッシュボード*から「新しい同期を作成」ボタンに移動し、image:icon-sync-action.png["同期関係でアクションを実行できるボタンのスクリーンショット"]
. 削除する同期関係を選択し、「*削除*」を選択してから、もう一度「*削除*」を選択して確認します。


.結果
コピーして同期すると、同期関係が削除されます。
