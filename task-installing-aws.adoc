---
sidebar: sidebar 
permalink: task-installing-aws.html 
keywords: data broker, install, aws, networking, permissions, regions, install data broker in aws, install in aws, deploy in aws, deploy data broker in aws, cft, template, iam role, use your own iam role, regions, supported regions, networking requirements, port, ports, 443, port 443, ntp, network time protocol, permissions, iam role, iam permissions, aws data broker 
summary: 新しいデータブローカーを作成するときは、AWS Data Broker オプションを選択して、VPC 内の新しい EC2 インスタンスにデータブローカーソフトウェアをデプロイします。  NetApp Copy and Sync はインストール プロセスをガイドしますが、インストールの準備に役立つように、このページに要件と手順が繰り返し記載されています。 
---
= NetApp Copy and Sync用の新しいデータブローカーを AWS に作成する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
NetApp Copy and Syncの新しいデータ ブローカー グループを作成するときは、Amazon Web Services を選択して、VPC 内の新しい EC2 インスタンスにデータ ブローカー ソフトウェアをデプロイします。  NetApp Copy and Sync はインストール プロセスをガイドしますが、インストールの準備に役立つように、このページに要件と手順が繰り返し記載されています。

クラウド内またはオンプレミスの既存の Linux ホストにデータ ブローカーをインストールすることもできます。link:task-installing-linux.html["詳細情報"] 。



== サポートされているAWSリージョン

中国地域を除くすべての地域がサポートされています。



== ルート権限

データ ブローカー ソフトウェアは、Linux ホスト上で自動的に root として実行されます。データ ブローカーを操作するには、root として実行する必要があります。たとえば、共有をマウントします。



== ネットワーク要件

* データ ブローカーには、ポート 443 経由でタスクのコピーと同期をポーリングできるように、送信インターネット接続が必要です。
+
Copy and Sync が AWS にデータブローカーをデプロイすると、必要なアウトバウンド通信を有効にするセキュリティグループが作成されます。インストール プロセス中にプロキシ サーバーを使用するようにデータ ブローカーを構成できることに注意してください。

+
アウトバウンド接続を制限する必要がある場合は、link:reference-networking.html["データブローカーが接続するエンドポイントのリスト"] 。

* NetApp、ソース、ターゲット、およびデータ ブローカーをネットワーク タイム プロトコル (NTP) サービスを使用するように構成することを推奨しています。  3 つのコンポーネント間の時間差は 5 分を超えてはなりません。




== AWS にデータブローカーをデプロイするために必要な権限

データブローカーをデプロイするために使用するAWSユーザーアカウントには、次の権限が必要です。 https://s3.amazonaws.com/metadata.datafabric.io/docs/aws_iam_policy.json["NetAppが提供するこのポリシー"^] 。



== [[iam]]AWSデータブローカーで独自のIAMロールを使用するための要件

Copy and Sync がデータ ブローカーをデプロイすると、データ ブローカー インスタンスの IAM ロールが作成されます。必要に応じて、独自の IAM ロールを使用してデータ ブローカーをデプロイすることもできます。組織に厳格なセキュリティ ポリシーがある場合は、このオプションを使用することをお勧めします。

IAM ロールは次の要件を満たしている必要があります。

* EC2 サービスには、信頼できるエンティティとして IAM ロールを引き受ける権限が必要です。
* link:media/aws_iam_policy_data_broker.json["このJSONファイルで定義された権限"^]データブローカーが適切に機能するには、IAM ロールに添付する必要があります。


データブローカーをデプロイするときに IAM ロールを指定するには、以下の手順に従います。



== データブローカーを作成する

新しいデータ ブローカーを作成するには、いくつかの方法があります。これらの手順では、同期関係を作成するときに AWS にデータブローカーをインストールする方法について説明します。

.手順
. link:task-login-copyandsync.html["コピーと同期にログイン"] 。
. *新しい同期を作成*を選択します。
. *同期関係の定義*ページで、ソースとターゲットを選択し、*続行*を選択します。
+
*データ ブローカー グループ* ページに到達するまで手順を完了します。

. *データ ブローカー グループ* ページで、*データ ブローカーの作成* を選択し、*Amazon Web Services* を選択します。
+
image:screenshot-aws.png["AWS、Azure、Google Cloud、オンプレミスのデータブローカーを選択できるデータブローカーページのスクリーンショット。"]

. データ ブローカーの名前を入力し、[続行] を選択します。
. AWS アクセスキーを入力すると、Copy and Sync がユーザーに代わって AWS にデータブローカーを作成できるようになります。
+
キーは保存されず、他の目的にも使用されません。

+
アクセス キーを提供したくない場合は、ページの下部にあるリンクを選択して、代わりに CloudFormation テンプレートを使用します。このオプションを使用する場合は、AWS に直接ログインするため、認証情報を提供する必要はありません。

+
[[cft]]次のビデオでは、CloudFormation テンプレートを使用してデータブローカーインスタンスを起動する方法を示します。

+
.AWS CloudFormation テンプレートからデータブローカーを起動する
video::abaf0898-ea15-4f84-938e-b24c010b21e8[panopto]
. AWS アクセスキーを入力した場合は、インスタンスの場所を選択し、キーペアを選択し、パブリック IP アドレスを有効にするかどうかを選択し、既存の IAM ロールを選択するか、フィールドを空白のままにして、コピーと同期によってロールが自動的に作成されるようにします。  KMS キーを使用してデータ ブローカーを暗号化するオプションもあります。
+
独自のIAMロールを選択した場合は、<<iam,必要な権限を与える必要があります>> 。

+
image:screenshot_aws_data_broker.png["AWS にデータブローカーをデプロイするときに提供する必要がある情報のスクリーンショット。"]

. VPC でのインターネット アクセスにプロキシが必要な場合は、プロキシ設定を指定します。
. データ ブローカーが利用可能になったら、[コピーと同期] で [*続行*] を選択します。
+
次の画像は、AWS に正常にデプロイされたインスタンスを示しています。

+
image:screenshot-data-broker-group-selected.png["このスクリーンショットは、正常にデプロイされたインスタンスを示しています。インターフェースには、AWS ネットワークを含むインスタンスの詳細が表示されます。"]

. ウィザードのページを完了して、新しい同期関係を作成します。


.結果
AWS にデータブローカーをデプロイし、新しい同期関係を作成しました。このデータ ブローカー グループを追加の同期関係で使用できます。



== データブローカーインスタンスの詳細

コピーと同期は、次の構成を使用して AWS にデータブローカーを作成します。

Node.js の互換性:: バージョン21.2.0
インスタンスタイプ:: リージョンで利用可能な場合は m5n.xlarge、そうでない場合は m5.xlarge
vCPU:: 4
RAM:: 16 GB
オペレーティング システム:: Amazon Linux 2023
ディスクのサイズと種類:: 10 GB GP2 SSD

